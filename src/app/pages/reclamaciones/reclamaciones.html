<div class="page-container">
  <div class="bg-gradient"></div>

  <div class="document-wrapper">
    <header class="doc-header">
      <div class="brand-area">
        <h1>Libro de Reclamaciones</h1>
        <p class="company-details">
          {{ companyInfo.razonSocial }} <br />
          RUC: {{ companyInfo.ruc }} <br />
          {{ companyInfo.address }}
        </p>
      </div>

      <div class="meta-data">
        <div class="data-box">
          <span class="label">HOJA DE RECLAMACI√ìN</span>
          <span class="code">{{ claimCode }}</span>
        </div>
        <div class="data-box date">
          <span class="label">FECHA</span>
          <span class="value">{{ currentDate | date : 'dd/MM/yyyy' }}</span>
        </div>
      </div>
    </header>

    <form [formGroup]="complaintForm" (ngSubmit)="onSubmit()" class="doc-body">
      <p class="intro-text">
        Conforme a lo establecido en el c√≥digo de protecci√≥n y defensa del consumidor, este
        establecimiento cuenta con un Libro de Reclamaciones a su disposici√≥n.
      </p>

      <section class="form-section">
        <div class="section-title">
          <span class="number">1</span>
          <h3>Identificaci√≥n del Consumidor Reclamante</h3>
        </div>

        <div class="grid-2">
          <div class="form-group">
            <label>Nombre Completo</label>
            <input type="text" formControlName="name" placeholder="Nombres y Apellidos" />
          </div>
          <div class="form-group doc-group">
            <div class="select-wrapper">
              <select formControlName="documentType">
                <option value="DNI">DNI</option>
                <option value="CE">CE</option>
                <option value="RUC">RUC</option>
              </select>
            </div>
            <input type="tel" formControlName="documentNumber" placeholder="N¬∞ Documento" />
          </div>
        </div>

        <div class="grid-2">
          <div class="form-group">
            <label>Correo Electr√≥nico</label>
            <input type="email" formControlName="email" placeholder="Para enviarle una copia" />
          </div>
          <div class="form-group">
            <label>Tel√©fono / Celular</label>
            <input type="tel" formControlName="phone" placeholder="999 999 999" />
          </div>
        </div>

        <div class="form-group full">
          <label>Domicilio</label>
          <input type="text" formControlName="address" placeholder="Direcci√≥n, Distrito, Ciudad" />
        </div>

        <div class="checkbox-simple">
          <label>
            <input type="checkbox" formControlName="isMinor" />
            <span>Soy menor de edad</span>
          </label>
        </div>

        @if (complaintForm.get('isMinor')?.value) {
        <div class="form-group full animated-fade">
          <label>Nombre del Padre o Apoderado</label>
          <input
            type="text"
            formControlName="parentName"
            placeholder="Nombre completo del representante"
          />
        </div>
        }
      </section>

      <hr class="divider" />

      <section class="form-section">
        <div class="section-title">
          <span class="number">2</span>
          <h3>Identificaci√≥n del Bien Contratado</h3>
        </div>

        <div class="radio-cards">
          <label class="radio-card">
            <input type="radio" formControlName="contractType" value="producto" />
            <div class="card-inner">
              <span class="icon">üì¶</span>
              <span>Producto</span>
            </div>
          </label>
          <label class="radio-card">
            <input type="radio" formControlName="contractType" value="servicio" />
            <div class="card-inner">
              <span class="icon">üõ†Ô∏è</span>
              <span>Servicio</span>
            </div>
          </label>
        </div>

        <div class="grid-amount-desc">
          <div class="form-group amount">
            <label>Monto Reclamado</label>
            <div class="currency-input">
              <span>S/</span>
              <input type="number" formControlName="amount" placeholder="0.00" />
            </div>
          </div>
          <div class="form-group">
            <label>Descripci√≥n</label>
            <input
              type="text"
              formControlName="description"
              placeholder="Ej. Zapatillas Nike Talla 42..."
            />
          </div>
        </div>
      </section>

      <hr class="divider" />

      <section class="form-section">
        <div class="section-title">
          <span class="number">3</span>
          <h3>Detalle de la Reclamaci√≥n</h3>
        </div>

        <div class="type-selector">
          <label class="type-box" [class.selected]="complaintForm.get('type')?.value === 'reclamo'">
            <input type="radio" formControlName="type" value="reclamo" />
            <div class="header">
              <strong>RECLAMO</strong>
            </div>
            <p>Disconformidad relacionada a los productos o servicios.</p>
          </label>

          <label class="type-box" [class.selected]="complaintForm.get('type')?.value === 'queja'">
            <input type="radio" formControlName="type" value="queja" />
            <div class="header">
              <strong>QUEJA</strong>
            </div>
            <p>Disconformidad no relacionada a los productos o servicios (ej: mala atenci√≥n).</p>
          </label>
        </div>

        <div class="form-group full">
          <label>Detalle del Reclamo/Queja</label>
          <textarea
            formControlName="detail"
            rows="4"
            placeholder="Describa los hechos detalladamente..."
          ></textarea>
        </div>

        <div class="form-group full">
          <label>Pedido del Consumidor</label>
          <textarea
            formControlName="request"
            rows="2"
            placeholder="¬øQu√© soluci√≥n espera? (Ej. Cambio de producto, devoluci√≥n...)"
          ></textarea>
        </div>
      </section>

      <div class="doc-footer">
        <div class="legal-check">
          <label>
            <input type="checkbox" formControlName="terms" />
            <span class="text"
              >Declaro ser el titular del servicio y acepto el tratamiento de mis datos personales
              seg√∫n la Pol√≠tica de Privacidad.</span
            >
          </label>
        </div>

        <div class="actions">
          <button
            type="submit"
            class="btn-submit"
            [disabled]="complaintForm.invalid || isSubmitting()"
            [class.is-loading]="isSubmitting()"
          >
            @if (isSubmitting()) {
            <div class="spinner"></div>
            Enviando... } @else { Registrar Reclamo }
          </button>
        </div>

        <p class="final-legal">
          * La formulaci√≥n del reclamo no impide acudir a otras v√≠as de soluci√≥n de controversias ni
          es requisito previo para interponer una denuncia ante el INDECOPI.<br />
          * El proveedor deber√° dar respuesta al reclamo en un plazo no mayor a quince (15) d√≠as
          h√°biles improrrogables.
        </p>
      </div>
    </form>
  </div>
</div>

@if (showSuccessModal()) {
<div class="success-overlay" (click)="closeSuccessModal()">
  <div class="success-card" (click)="$event.stopPropagation()">
    <div class="success-icon">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="20 6 9 17 4 12"></polyline>
      </svg>
    </div>

    <h2>¬°Reclamo Registrado!</h2>
    <p class="subtitle">Hemos enviado una constancia a tu correo.</p>

    <div class="code-box">
      <span class="label">TU C√ìDIGO DE SEGUIMIENTO</span>
      <div class="code-display">
        {{ registeredCode() }}
        <button class="copy-btn" (click)="copyCode()" title="Copiar">
          <svg
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
          </svg>
        </button>
      </div>
    </div>

    <p class="legal-note">
      Guarda este c√≥digo. Daremos respuesta en un plazo m√°ximo de 15 d√≠as h√°biles.
    </p>

    <button class="btn-close-modal" (click)="closeSuccessModal()">Entendido, gracias</button>
  </div>
</div>
}
