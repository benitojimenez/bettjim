<div class="points-container">

  <header class="page-header">
    <h1>Mis Puntos Bettjim</h1>
    <p>Acumula puntos por tus compras y canjÃ©alos por descuentos.</p>
  </header>

  <section class="points-hero">
    <div class="card-bg"></div> <div class="hero-content">
      <div class="balance-section">
        <span class="label">Saldo Disponible</span>
        <h2 class="points-total">
          {{ userLevel().currentPoints }} <span class="pts-text">PTS</span>
        </h2>
        <p class="money-equiv">â‰ˆ {{ userLevel().monetaryValue | currency:'PEN' }} en descuentos</p>
      </div>

      <div class="tier-badge">
        <svg fill="currentColor" viewBox="0 0 24 24"><path d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"/></svg>
        <span>Nivel {{ userLevel().tierName }}</span>
      </div>
    </div>

    <a routerLink="/account/coupons" class="btn-redeem">
      Canjear Puntos
      <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" /></svg>
    </a>
  </section>

  <section class="level-progress-card">
    <div class="progress-header">
      <h3>Siguiente Nivel: <strong>{{ userLevel().nextTierName }}</strong></h3>
      <span class="points-left">Faltan {{ userLevel().pointsToNextTier }} pts</span>
    </div>
    
    <div class="progress-bar-bg">
      <div class="progress-fill" [style.width.%]="userLevel().tierProgress"></div>
    </div>
    
    <p class="benefit-hint">
      ðŸŽ‰ Al llegar a Oro obtendrÃ¡s <strong>EnvÃ­os Gratis</strong> en todas tus compras.
    </p>
  </section>

  <section class="history-section">
    <h2>Historial de Movimientos</h2>

    <div class="transactions-list">
      @for (trx of history(); track trx.id) {
        <div class="trx-item">
          
          <div class="trx-icon" [ngClass]="getTypeClass(trx.type)">
             <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
               <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" [attr.d]="getTypeIcon(trx.type) === 'M12 6v6m0 0v6m0-6h6m-6 0H6' ? 'M5 10l7-7m0 0l7 7m-7-7v18' : 'M19 14l-7 7m0 0l-7-7m7 7V3'" />
             </svg>
          </div>

          <div class="trx-info">
            <span class="description">{{ trx.description }}</span>
            <span class="date">{{ trx.date | date:'d MMM y, h:mm a' }}</span>
          </div>

          <div class="trx-amount" [ngClass]="getTypeClass(trx.type)">
            {{ trx.amount > 0 ? '+' : '' }}{{ trx.amount }} pts
          </div>
        </div>
      } @empty {
        <div class="empty-history">
          <p>AÃºn no tienes movimientos.</p>
        </div>
      }
    </div>
  </section>

</div>